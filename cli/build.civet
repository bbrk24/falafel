from esbuild import { build }
from @danielx/civet/esbuild import civetPlugin
from node:path import * as path

await build
  entryPoints:
    . path.join 'src', 'index.civet'
  bundle: true
  platform: 'node'
  outdir: 'dist'
  format: 'esm'
  plugins:
    // @ts-expect-error
    . civetPlugin { +inlineMap, +typecheck, ts: 'preserve', parseOptions: { +comptime } }
  minify: true
  banner: js: '#!/usr/bin/env node'
  sourcemap: 'external'
